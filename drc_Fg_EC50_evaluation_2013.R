#http://www.darrenkoppel.com/2020/09/04/dose-response-modelling-and-model-selection-in-r/
#EC50 calculation for 2013 isolates
#**************************Load library and load input dataset ***************************#
library(tidyverse)
library(drc)
TEB_EC50 <- read.csv(file = "FgEC50eval_TEB_drc_R.csv", sep = ",", header = TRUE)
str(TEB_EC50)
TEB_EC50$Trial <- as.factor(TEB_EC50$Trial)
TEB_EC50$Isolate <- as.factor(TEB_EC50$Isolate)
TEB_EC50$Rep <- as.factor(TEB_EC50$Rep)
TEB_EC50$Fungicide <- as.factor(TEB_EC50$Fungicide)

#*******************Step1: Data input*****************************************************#
#start by converting all the responses into a percent of the control response
toxdata <- toxdata %>% 
  mutate(percent_response = rootl/(mean(toxdata$rootl[toxdata$conc==0]))*100)
TEB_EC50_Percentresponse <- TEB_EC50 %>%
  mutate(percent_response = Growth/(mean(TEB_EC50$Growth[TEB_EC50$Conc==0]))*100)
F13_9.percent <- subset(TEB_EC50_Percentresponse, (Isolate=="F13_9"))
PH1DEC6.percent <- subset(TEB_EC50_Percentresponse, (Isolate=="PH-1_DEC6"))

#check that we now have a response out of 100
head(R1261.percent)

#********************************* Step2: Choose a model*********************************#
#Choosing a model
#The drc package is kind enough to have a function made to compare models, 
#‘mselect’ which is a part of the drc package. The key inputs include a model 
#(so run any one first), a list of models you want to compare the initial model to “fctList”, 
#and whether you want to chuck in a linear regression “linreg” (as well as cubic and quadratic). 
#Because we’re using percent response as our response variable, I will fix three parameter 
#models to start at 100.
modelF13_9.1.LL3<- drm(percent_response~Conc, data=F13_9.percent, fct=LL.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit", "ED50")))
mselect(modelF13_9.1.LL3, fctList = list(W1.3(fixed=c(NA, 100, NA)),W1.4(), W2.3(fixed=c(NA, 100, NA)), W2.4(),  LL.4()),linreg=TRUE) 

modelPH1DEC6.1.LL3<- drm(percent_response~Conc, data=PH1DEC6.percent, fct=LL.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit", "ED50")))
mselect(modelPH1DEC6.1.LL3, fctList = list(W1.3(fixed=c(NA, 100, NA)),W1.4(), W2.3(fixed=c(NA, 100, NA)), W2.4(),  LL.4()),linreg=TRUE) 

#*******Step3: picking up best model and plotting dose response curve******************#

modelPH1.1.W13 <-  drm(percent_response~Conc, data=PH1.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_6.1.W14 <-  drm(percent_response~Conc, data=F13_6.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope","Lower Limit", "Upper Limit",  "ED50")))
modelF13_16.1.W14 <-  drm(percent_response~Conc, data=F13_16.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelPH1OCT30.1.W14 <-  drm(percent_response~Conc, data=PH1OCT30.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_17.1.W13 <-  drm(percent_response~Conc, data=F13_17.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_28.1.W13 <-  drm(percent_response~Conc, data=F13_28.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_41.1.W14 <-  drm(percent_response~Conc, data=F13_41.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_42.1.W14 <-  drm(percent_response~Conc, data=F13_42.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_44.1.W14 <-  drm(percent_response~Conc, data=F13_44.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_45.1.W14 <-  drm(percent_response~Conc, data=F13_45.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_46.1.W14 <-  drm(percent_response~Conc, data=F13_46.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_48.1.W14 <-  drm(percent_response~Conc, data=F13_48.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_52.1.W13 <-  drm(percent_response~Conc, data=F13_52.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_54.1.W14 <-  drm(percent_response~Conc, data=F13_54.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_58.1.W14 <-  drm(percent_response~Conc, data=F13_58.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_63.1.W14 <-  drm(percent_response~Conc, data=F13_63.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope","Lower Limit" ,"Upper Limit",  "ED50")))
modelPH1NOV11.1.W24 <-  drm(percent_response~Conc, data=PH1NOV11.percent, fct=W2.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_27.1.W14 <-  drm(percent_response~Conc, data=F13_27.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_51.1.W14 <-  drm(percent_response~Conc, data=F13_51.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_53.1.W14 <-  drm(percent_response~Conc, data=F13_53.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_56.1.W13 <-  drm(percent_response~Conc, data=F13_56.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_57.1.W13 <-  drm(percent_response~Conc, data=F13_57.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_62.1.W14 <-  drm(percent_response~Conc, data=F13_62.percent, fct=W1.4(fixed=c(NA, 0,  100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_64.1.W14 <-  drm(percent_response~Conc, data=F13_64.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_68.1.W14 <-  drm(percent_response~Conc, data=F13_68.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_72.1.W14 <-  drm(percent_response~Conc, data=F13_72.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_73.1.W13 <-  drm(percent_response~Conc, data=F13_73.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_74.1.W13 <-  drm(percent_response~Conc, data=F13_74.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_65.1.W14 <-  drm(percent_response~Conc, data=F13_65.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_66.1.W14 <-  drm(percent_response~Conc, data=F13_66.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_142.1.LL4 <-  drm(percent_response~Conc, data=F13_142.percent, fct=LL.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_143.1.LL4 <-  drm(percent_response~Conc, data=F13_143.percent, fct=LL.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_144.1.W24 <-  drm(percent_response~Conc, data=F13_144.percent, fct=W2.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_147.1.LL4 <-  drm(percent_response~Conc, data=F13_147.percent, fct=LL.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_148.1.W14 <-  drm(percent_response~Conc, data=F13_148.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_159.1.W14 <-  drm(percent_response~Conc, data=F13_159.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_160.1.W13 <-  drm(percent_response~Conc, data=F13_160.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_174.1.W24 <-  drm(percent_response~Conc, data=F13_174.percent, fct=W2.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_175.1.W24 <-  drm(percent_response~Conc, data=F13_175.percent, fct=W2.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_179.1.LL4 <-  drm(percent_response~Conc, data=F13_179.percent, fct=LL.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_181.1.LL3 <-  drm(percent_response~Conc, data=F13_181.percent, fct=LL.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_188.1.W24 <-  drm(percent_response~Conc, data=F13_188.percent, fct=W2.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_193.1.W24 <-  drm(percent_response~Conc, data=F13_193.percent, fct=W2.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelPH1NOV29.1.W13 <-  drm(percent_response~Conc, data=PH1NOV29.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_39.1.W23 <-  drm(percent_response~Conc, data=F13_39.percent, fct=W2.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_71.1.W23 <-  drm(percent_response~Conc, data=F13_71.percent, fct=W2.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_91.1.W13 <-  drm(percent_response~Conc, data=F13_91.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_92.1.W14 <-  drm(percent_response~Conc, data=F13_92.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_93.1.W14 <-  drm(percent_response~Conc, data=F13_93.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_111.1.W13 <-  drm(percent_response~Conc, data=F13_111.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_113.1.W13 <-  drm(percent_response~Conc, data=F13_113.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_114.1.LL4 <-  drm(percent_response~Conc, data=F13_114.percent, fct=LL.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_187.1.W13 <-  drm(percent_response~Conc, data=F13_187.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_189.1.W14 <-  drm(percent_response~Conc, data=F13_189.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_115.1.W13 <-  drm(percent_response~Conc, data=F13_115.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelPH1DEC2.1.W14 <-  drm(percent_response~Conc, data=PH1DEC2.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_3.1.W14 <-  drm(percent_response~Conc, data=F13_3.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_4.1.W14 <-  drm(percent_response~Conc, data=F13_4.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_5.1.W14 <-  drm(percent_response~Conc, data=F13_5.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_7.1.W14 <-  drm(percent_response~Conc, data=F13_7.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_14.1.W14 <-  drm(percent_response~Conc, data=F13_14.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_69.1.W14 <-  drm(percent_response~Conc, data=F13_69.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_78.1.W14 <-  drm(percent_response~Conc, data=F13_78.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_80.1.W14 <-  drm(percent_response~Conc, data=F13_80.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_81.1.W14 <-  drm(percent_response~Conc, data=F13_81.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_83.1.W14 <-  drm(percent_response~Conc, data=F13_83.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_84.1.W14 <-  drm(percent_response~Conc, data=F13_84.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_85.1.W14 <-  drm(percent_response~Conc, data=F13_85.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_87.1.W13 <-  drm(percent_response~Conc, data=F13_87.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_138.1.W14 <-  drm(percent_response~Conc, data=F13_138.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_163.1.W14 <-  drm(percent_response~Conc, data=F13_163.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelPH1DEC6.1.W14 <-  drm(percent_response~Conc, data=PH1DEC6.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope","Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_8.1.W14 <-  drm(percent_response~Conc, data=F13_8.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_9.1.W14 <-  drm(percent_response~Conc, data=F13_9.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_10.1.W14 <-  drm(percent_response~Conc, data=F13_10.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_11.1.W14 <-  drm(percent_response~Conc, data=F13_11.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_12.1.W14 <-  drm(percent_response~Conc, data=F13_12.percent, fct=W1.4(fixed=c(NA,0,100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_26.1.W14 <-  drm(percent_response~Conc, data=F13_26.percent, fct=W1.4(fixed=c(NA,0 ,100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_33.1.W14 <-  drm(percent_response~Conc, data=F13_33.percent, fct=W1.4(fixed=c(NA,0 ,100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_34.1.W14 <-  drm(percent_response~Conc, data=F13_34.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_35.1.W14 <-  drm(percent_response~Conc, data=F13_35.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_40.1.W14 <-  drm(percent_response~Conc, data=F13_40.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_49.1.W14 <-  drm(percent_response~Conc, data=F13_49.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_50.1.W14 <-  drm(percent_response~Conc, data=F13_50.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_60.1.W14 <-  drm(percent_response~Conc, data=F13_60.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_67.1.W14 <-  drm(percent_response~Conc, data=F13_67.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_90.1.W14 <-  drm(percent_response~Conc, data=F13_90.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_101.1.W14 <-  drm(percent_response~Conc, data=F13_101.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_102.1.W14 <-  drm(percent_response~Conc, data=F13_102.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_105.1.W14 <-  drm(percent_response~Conc, data=F13_105.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_109.1.W14 <-  drm(percent_response~Conc, data=F13_109.percent, fct=W1.4(fixed=c(NA,0,100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_117.1.W14 <-  drm(percent_response~Conc, data=F13_117.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_119.1.W14 <-  drm(percent_response~Conc, data=F13_119.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_127.1.W13 <-  drm(percent_response~Conc, data=F13_127.percent, fct=W1.3(fixed=c(NA, 100, NA), names = c("Slope", "Upper Limit",  "ED50")))
modelF13_128.1.W14 <-  drm(percent_response~Conc, data=F13_128.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_130.1.W14 <-  drm(percent_response~Conc, data=F13_130.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_152.1.W14 <-  drm(percent_response~Conc, data=F13_152.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_177.1.LL4 <-  drm(percent_response~Conc, data=F13_177.percent, fct=LL.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_185.1.W14 <-  drm(percent_response~Conc, data=F13_185.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_190.1.W14 <-  drm(percent_response~Conc, data=F13_190.percent, fct=W1.4(fixed=c(NA,0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_191.1.W14 <-  drm(percent_response~Conc, data=F13_191.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope","Lower Limit","Upper Limit",  "ED50")))
modelF13_23.1.W14 <-  drm(percent_response~Conc, data=F13_23.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit","Upper Limit",  "ED50")))
modelF13_146.1.W14 <-  drm(percent_response~Conc, data=F13_146.percent, fct=W1.4(fixed=c(NA, 0, 100, NA), names = c("Slope", "Lower Limit", "Upper Limit",  "ED50")))
modelF13_180.1.W14 <-  drm(percent_response~Conc, data=F13_180.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))
modelF13_192.1.W14 <-  drm(percent_response~Conc, data=F13_192.percent, fct=W1.4(fixed=c(NA, 0,100, NA), names = c("Slope", "Lower Limit" ,"Upper Limit",  "ED50")))

tiff("DRC_2013Isolates_TEB.tiff", units = "in", height = 9, width = 9, res = 300)
plot(modelPH1.1.W13, main="Dose Response Curve: Tebuconazole: 2013-Isolates",xlab="Fungicide Concentration (mg/L)", ylab="Percent Growth Inhibition",  type='all', pch =1,lty=1, lwd=2)
plot(modelF13_6.1.W14, add = TRUE, col = colors()[1], pch =2, lty=2, lwd=2)
plot(modelF13_16.1.W14, add = TRUE, col = colors()[5], pch =3, lty=3, lwd=2)
plot(modelF13_17.1.W13, add = TRUE, col = colors()[15],pch = 4, lty = 4, lwd=2)
plot(modelF13_28.1.W14, add = TRUE, col = colors()[25], pch =5, lty=5, lwd=2)
plot(modelF13_41.1.W14, add = TRUE, col = colors()[35], pch =6, lty=6, lwd=2)
plot(modelF13_42.1.W14, add = TRUE, col = colors()[45],pch = 7, lty =7, lwd=2)
plot(modelF13_44.1.W24, add = TRUE, col = colors()[55], pch =8, lty=8, lwd=2)
plot(modelF13_45.1.W14, add = TRUE, col = colors()[65], pch =9, lty=9, lwd=2)
plot(modelF13_46.1.W14, add = TRUE, col = colors()[75], pch =10, lty=10, lwd=2)
plot(modelF13_48.1.W14, add = TRUE, col = colors()[85],pch = 11, lty = 11, lwd=2)
plot(modelF13_52.1.W14, add = TRUE, col = colors()[95], pch =12, lty=12, lwd=2)
plot(modelF13_54.1.W14, add = TRUE, col = colors()[105], pch =13, lty=13, lwd=2)
plot(modelF13_58.1.W14, add = TRUE, col = colors()[115], pch =14, lty=14, lwd=2)
plot(modelF13_63.1.W14, add = TRUE, col = colors()[125], pch =15, lty=15, lwd=2)
plot(modelF13_27.1.W14, add = TRUE, col = colors()[135], pch =16, lty=16, lwd=2)
plot(modelF13_51.1.W14, add = TRUE, col = colors()[145],pch = 17, lty = 17, lwd=2)
plot(modelF13_53.1.W14, add = TRUE, col = colors()[155], pch =18, lty=18, lwd=2)
plot(modelF13_56.1.W13, add = TRUE, col = colors()[165],pch = 19, lty = 19, lwd=2)
plot(modelF13_57.1.W14, add = TRUE, col = colors()[175], pch =20, lty=20, lwd=2)
plot(modelF13_62.1.W14, add = TRUE, col = colors()[185], pch =21, lty=21, lwd=2)
plot(modelF13_64.1.W14, add = TRUE, col = colors()[195], pch =22, lty=22, lwd=2)
plot(modelF13_68.1.W13, add = TRUE, col = colors()[205],pch = 23, lty = 23, lwd=2)
plot(modelF13_72.1.W14, add = TRUE, col = colors()[215], pch =24, lty=24, lwd=2)
plot(modelF13_73.1.W14, add = TRUE, col = colors()[225], pch =25, lty=25, lwd=2)
plot(modelF13_74.1.W13, add = TRUE, col = colors()[235],pch = 1, lty = 1, lwd=2)
plot(modelF13_65.1.W14, add = TRUE, col = colors()[245], pch =2, lty=2, lwd=2)
plot(modelF13_66.1.W14, add = TRUE, col = colors()[255], pch =3, lty=3, lwd=2)
plot(modelF13_142.1.W24, add = TRUE, col = colors()[265],pch =4, lty =4, lwd=2)
plot(modelF13_143.1.W24, add = TRUE, col = colors()[275],pch =5, lty =5, lwd=2)
plot(modelF13_144.1.W14, add = TRUE, col = colors()[285],pch =6, lty =6, lwd=2)
plot(modelF13_147.1.W14, add = TRUE, col = colors()[295],pch =7, lty =7, lwd=2)

plot(modelF13_10.1.W14, add = TRUE, col = colors()[37],pch =5, lty =5, lwd=2)
plot(modelF13_11.1.W14, add = TRUE, col = colors()[36],pch =6, lty =6, lwd=2)
plot(modelF13_12.1.W14, add = TRUE, col = colors()[34],pch =7, lty =7, lwd=2)
plot(modelF13_26.1.W14, add = TRUE, col = colors()[33],pch =8, lty =8, lwd=2)
plot(modelF13_33.1.W14, add = TRUE, col = colors()[32],pch =9, lty =9, lwd=2)
plot(modelF13_34.1.W14, add = TRUE, col = colors()[31],pch =10, lty =10, lwd=2)
plot(modelF13_35.1.W14, add = TRUE, col = colors()[29],pch =11, lty =11, lwd=2)
plot(modelF13_40.1.W14, add = TRUE, col = colors()[28],pch =12, lty =12, lwd=2)
plot(modelF13_49.1.W14, add = TRUE, col = colors()[27],pch =13, lty =13, lwd=2)
plot(modelF13_50.1.W14, add = TRUE, col = colors()[26],pch =14, lty =14, lwd=2)
plot(modelF13_67.1.W14, add = TRUE, col = colors()[24],pch =15, lty =15, lwd=2)
plot(modelF13_90.1.W14, add = TRUE, col = colors()[23],pch =16, lty =16, lwd=2)
plot(modelF13_101.1.W14, add = TRUE, col = colors()[22],pch =17, lty =17, lwd=2)
plot(modelF13_102.1.W14, add = TRUE, col = colors()[21],pch =18, lty =18, lwd=2)
plot(modelF13_105.1.W14, add = TRUE, col = colors()[19],pch =19, lty =19, lwd=2)
plot(modelF13_109.1.W14, add = TRUE, col = colors()[18],pch =20, lty =20, lwd=2)
plot(modelF13_117.1.W14, add = TRUE, col = colors()[17],pch =21, lty =21, lwd=2)
plot(modelF13_119.1.W14, add = TRUE, col = colors()[16],pch =22, lty =22, lwd=2)
plot(modelF13_127.1.W13, add = TRUE, col = colors()[14],pch =23, lty =23, lwd=2)
plot(modelF13_128.1.W14, add = TRUE, col = colors()[13],pch =24, lty =24, lwd=2)
plot(modelF13_130.1.W14, add = TRUE, col = colors()[12],pch =25, lty =25, lwd=2)
plot(modelF13_152.1.W14, add = TRUE, col = colors()[11],pch =1, lty =1, lwd=2)
plot(modelF13_185.1.W14, add = TRUE, col = colors()[9],pch =2, lty =2, lwd=2)
plot(modelF13_190.1.W14, add = TRUE, col = colors()[8],pch =3, lty =3, lwd=2)
plot(modelF13_191.1.W14, add = TRUE, col = colors()[7],pch =4, lty =4, lwd=2)
plot(modelF13_23.1.W14, add = TRUE, col = colors()[6],pch =5, lty =5, lwd=2)
plot(modelF13_146.1.W14, add = TRUE, col = colors()[4],pch =6, lty =6, lwd=2)
plot(modelF13_180.1.W14, add = TRUE, col = colors()[3], pch=7, lty = 7, lwd=2)
plot(modelF13_192.1.W14, add = TRUE, col = colors()[2], pch=8, lty = 8, lwd=2)
legend(20,110, legend = c("PH-1","F13_6","F13_16","F13_17","F13_28","F13_41","F13_42","F13_44","F13_45","F13_46","F13_48","F13_52","F13-54","F13_58","F13-63","F13_27","F13_51","F13_53","F13_56","F13-57","F13-62","F13-64","F13-68"), col = c("Black",colors()[1],colors()[10],colors()[20],colors()[30],colors()[40],colors()[50],colors()[60],colors()[70],colors()[80],colors()[90],colors()[100],colors()[110],colors()[120],colors()[130],colors()[140],colors()[150],colors()[160],colors()[170],colors()[180],colors()[190],colors()[200],colors()[210]), lty = 140, cex = 0.65)
legend(60,110, legend = c("F13-72","F13-73","F13-74","F13_65","F13_66","F13_142","F13_143","F13_144","F13_147"), col = c(colors()[220],colors()[230],colors()[240],colors()[250],colors()[260],colors()[270],colors()[280],colors()[290],colors()[300]), cex = 0.65)
dev.off()

ED(modelF13_9.1.W14, 50, interval = "delta")
ED(modelPH1DEC6.1.W14, 50, interval = "delta")

colors()
